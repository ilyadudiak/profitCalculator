<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Калькулятор доходности</title>
</head>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<body>
    <div class="calculator">
        <div class="calculator-top-bar">
            <p>Розрахувати окупність обладнання </p>
            <button class="calculator-top-bar__close">

                <svg width="35" height="35" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M17.5 35C7.85011 35 0 27.1499 0 17.5C0 7.85011 7.85011 0 17.5 0C27.1499 0 35 7.85011 35 17.5C35 27.1499 27.1499 35 17.5 35ZM17.5 2.1875C9.05628 2.1875 2.1875 9.05628 2.1875 17.5C2.1875 25.9437 9.05628 32.8125 17.5 32.8125C25.9437 32.8125 32.8125 25.9437 32.8125 17.5C32.8125 9.05628 25.9437 2.1875 17.5 2.1875Z"
                        fill="#CCCCCC"></path>
                    <path
                        d="M12.0857 24.0068C11.8056 24.0068 11.5254 23.9005 11.3126 23.6861C10.8854 23.2589 10.8854 22.5662 11.3126 22.139L22.1406 11.3107C22.5682 10.8834 23.2608 10.8834 23.6881 11.3107C24.1153 11.7379 24.1153 12.4306 23.6881 12.8581L12.8598 23.6861C12.644 23.9005 12.3642 24.0068 12.0857 24.0068Z"
                        fill="#CCCCCC"></path>
                    <path
                        d="M22.9136 24.0074C22.6338 24.0074 22.3537 23.9011 22.1408 23.6867L11.3128 12.86C10.8853 12.4327 10.8853 11.7401 11.3128 11.3128C11.7401 10.8853 12.4327 10.8853 12.86 11.3128L23.688 22.1408C24.1155 22.5681 24.1155 23.2608 23.688 23.688C23.4738 23.9011 23.1937 24.0074 22.9136 24.0074Z"
                        fill="#CCCCCC"></path>
                </svg>
            </button>
        </div>
        <div class="calculator-data">
            [
            {
            "name": "Asclepion MeDioStar Monolith",
            "img": "calculator-product1.jpg",
            "pocedureMin": 1,
            "pocedureMax": 7,
            "priceMin": 400,
            "priceMax": 2000,
            "suppliesPrice": 127
            },
            {
            "name": "Asclepion Dermablate",
            "img": "calculator-product2.png",
            "pocedureMin": 1,
            "pocedureMax": 3,
            "priceMin": 2990,
            "priceMax": 7990,
            "suppliesPrice": 115
            },
            {
            "name": "Asclepion The Epilab",
            "img": "calculator-product3.jpg",
            "pocedureMin": 1,
            "pocedureMax": 7,
            "priceMin": 400,
            "priceMax": 2000,
            "suppliesPrice": 127
            },
            {
            "name": "Asclepion QuadrostarPRO",
            "img": "calculator-product4.jpg",
            "pocedureMin": 1,
            "pocedureMax": 4,
            "priceMin": 1650,
            "priceMax": 2950,
            "suppliesPrice": 50
            },
            {
            "name": "Wontech Tightan",
            "img": "calculator-product5.jpg",
            "pocedureMin": 1,
            "pocedureMax": 7,
            "priceMin": 6000,
            "priceMax": 48000,
            "suppliesPrice": 3575
            },
            {
            "name": "Starvac DX Smart",
            "img": "calculator-product6.jpg",
            "pocedureMin": 1,
            "pocedureMax": 8,
            "priceMin": 300,
            "priceMax": 800,
            "suppliesPrice": 25
            },
            {
            "name": "Starvac DX Twin",
            "img": "calculator-product7.jpg",
            "pocedureMin": 1,
            "pocedureMax": 7,
            "priceMin": 450,
            "priceMax": 1000,
            "suppliesPrice": 37.7
            }
            ]
        </div>
        <div class="calculator-top">

            <div class="calculator-top-left">
                <select name="calculator-top-select" id="calculator-top-select">

                </select>
                <div class="calculator-top-left__img"></div>
            </div>
            <div class="calculator-top-right">
                <div class="calculator-top__item">
                    <div class="calculator-top__item-top">
                        <p>Кількість робочих днів </p>
                        <span id="calculatorWorkDays">1</span>
                    </div>
                    <input type="range" value="1" step="1" max="30" min="1" id="calculatorInputWorkDays">
                    <div class="calculator-top__item-bottom">
                        <p>min 1</p>
                        <p>max 30</p>
                    </div>
                </div>
                <div class="calculator-top__item">
                    <div class="calculator-top__item-top">
                        <p>Кількість процедур на день </p>
                        <span id="calculatorProcedurePerDay">1</span>
                    </div>
                    <input type="range" value="1" step="1" max="7" min="1" id="calculatorInputProcedurePerDay">
                    <div class="calculator-top__item-bottom">
                        <p>min 1</p>
                        <p>max <span id="calculatorProcedurePerDayMax"></span></p>
                    </div>
                </div>
                <div class="calculator-top__item">
                    <div class="calculator-top__item-top">
                        <p>Вартість процедури
                        </p>
                        <span id="calculatorProcedurePrice">400</span>
                    </div>
                    <input type="range" value="400" step="50" max="2000" min="400" id="calculatorInputProcedurePrice">
                    <div class="calculator-top__item-bottom">
                        <p>min <span id="calculatorProcedurePriceMin"></span></p>
                        <p>max <span id="calculatorProcedurePriceMax"></span></p>
                    </div>
                </div>
            </div>
        </div>
        <div class="calculator-statistics">
            <div class="calculator-statistics-item">
                <p class="calculator-statistics-item__title">
                    Витрати на процедуру
                </p>

                <table class="calculator-statistics-item__body">
                    <!-- <div class="calculator-statistics-item__block">
                        <div class="calculator-statistics-item__block-container">
                            <p>Бонус співробітникам </p>
                            <span> <span id="calculatorEmployeeBonus"></span> грн (25%)</span>
                        </div>

                    </div>
                    <div class="calculator-statistics-item__block">
                        <div class="calculator-statistics-item__block-container">
                            <p>Витратні матеріали </p>
                            <span> <span id="calculatorSupplies"></span> грн</span>
                        </div>

                    </div> -->
                    <tbody>
                        <tr>
                            <td>
                                <strong>Бонус співробітникам</strong>
                            </td>
                            <td><span> <span id="calculatorEmployeeBonus"></span> грн (25%)</span></td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Витратні матеріали</strong>
                            </td>
                            <td><span> <span id="calculatorSupplies"></span> грн</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <canvas id="payback-chart" data-labels='["0","1 рік","2 роки","3 роки","4 роки","5 років"]'
            data-values='[0, 2000000, 6000000, 8000000, 10000000, 12000000]'></canvas>
    </div>

</body>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script src="js/calculator.js"></script>
<script type="text/javascript" data-pagespeed-no-defer>pagespeed.lazyLoadImages.overrideAttributeFunctions();</script>
<script>
    let currentChartData = [0, 0, 0, 0, 0, 0];
    $('[data-modal]').click(function (event) {
        event.preventDefault();
        const modalBtn = $(this);
        const modal = $('.js-modal');
        const modalContent = modal.find('.modal__body');
        const modalId = modalBtn.attr('data-modal');
        const modalHTML = $("#" + modalId).clone();
        modalContent.html(modalHTML);
        const modalBackdrop = $('.js-modal-backdrop');
        modalBackdrop.fadeIn();
        modal.fadeIn();
        modal.scrollTop(0); // inner content posision top on each new opened modal
        $('input[type="tel"]').inputmask("+38 (999) 999-99-99");
        if (modalBtn.attr('data-modal-title')) {
            modal.find('.modal__title').text(modalBtn.attr('data-modal-title'))
        }
        if (modalBtn.attr('data-video-url') && modalBtn.attr('data-modal-player')) {
            modal.find('video').removeClass('d-none');
            modal.find('iframe').addClass('d-none');
            modal.find('video').attr('src', modalBtn.attr('data-video-url'));
        }
        if (modalBtn.attr('data-video-url') && !modalBtn.attr('data-modal-player')) {
            modal.find('video').addClass('d-none');
            modal.find('iframe').removeClass('d-none');
            modal.find('iframe').attr('src', modalBtn.attr('data-video-url'));
        }
        if (modalBtn.attr('data-modal-message')) {
            modal.find('.modal__message').text(modalBtn.attr('data-modal-message'))
        }
        if (modalBtn.attr('data-modal-submessage')) {
            modal.find('.modal__submessage').text(modalBtn.attr('data-modal-submessage'))
        }
        if (modalBtn.attr('data-payback-equipment')) {
            let calcData = [
                {
                    id: 'paybacks1',
                    minProcedures: 1,
                    maxProcedures: 7,
                    minCost: 400,
                    maxCost: 2000,
                    productImg: 'images/оборудование/Asclepion/Monolith/ASCLEPION_MEDIOSTAR_MONOLITH.jpg',
                    consumables: 127,
                    employee_bonus: 0.25
                }
                , {
                    id: 'paybacks2',
                    minProcedures: 1,
                    maxProcedures: 3,
                    minCost: 2990,
                    maxCost: 7990,
                    productImg: 'images/оборудование/Asclepion/Dermablate/Dermablate_Display2.png',
                    consumables: 115,
                    employee_bonus: 0.300
                }
                , {
                    id: 'paybacks3',
                    minProcedures: 1,
                    maxProcedures: 7,
                    minCost: 400,
                    maxCost: 2000,
                    productImg: 'images/оборудование/Asclepion/The-Epilab-2023/asclepion-epilab-2023-1.jpg',
                    consumables: 127,
                    employee_bonus: 0.25
                }
                , {
                    id: 'paybacks4',
                    minProcedures: 1,
                    maxProcedures: 4,
                    minCost: 1650,
                    maxCost: 2950,
                    productImg: 'images/оборудование/Asclepion/QuadrostarPro/QSPRO_case.jpg',
                    consumables: 50,
                    employee_bonus: 0.30
                }
                , {
                    id: 'paybacks5',
                    minProcedures: 1,
                    maxProcedures: 7,
                    minCost: 6000,
                    maxCost: 48000,
                    productImg: 'images/оборудование/WONTECH/ULTRASKIN TIGHTAN/ultraskin-tightan-cover.jpg',
                    consumables: 3575,
                    employee_bonus: 0.30
                }
                , {
                    id: 'paybacks6',
                    minProcedures: 1,
                    maxProcedures: 8,
                    minCost: 300,
                    maxCost: 800,
                    productImg: 'images/оборудование/STARVAC/DXSMART/starvac-dxsmart-prev-1.jpg',
                    consumables: 25,
                    employee_bonus: 0.250
                }
                , {
                    id: 'paybacks7',
                    minProcedures: 1,
                    maxProcedures: 7,
                    minCost: 450,
                    maxCost: 1000,
                    productImg: 'images/оборудование/dx twin prev.jpg',
                    consumables: 37.7,
                    employee_bonus: 0.25
                }
            ];
            let currentValues = {
                days: 1,
                procedures: calcData[0].minProcedures,
                cost: calcData[0].minCost,
                consumables: calcData[0].consumables,
                employee_bonus: calcData[0].employee_bonus
            }
            console.log('currentChartData', currentChartData)
            // chart
            var ctx = document.getElementById("payback-chart").getContext("2d");
            var gradient = ctx.createLinearGradient(1000, 0, 0, 0);
            gradient.addColorStop(0, 'rgba(0, 113, 223, 0.6)');
            gradient.addColorStop(1, 'rgba(0, 113, 223, 0)');
            const chartLabels = $('#payback-chart').data('labels');
            const chartValues = $('#payback-chart').data('values');
            const chartData = {
                labels: chartLabels,
                datasets: [{
                    backgroundColor: gradient,
                    fill: true,
                    borderColor: 'rgb(0, 113, 223)',
                    datalabels: {
                        color: '#545459',
                        anchor: function (context) {
                            let anc = 'left';
                            switch (context.dataIndex) {
                                case 1:
                                    anc = 'start';
                                    break;
                                case 2:
                                    anc = 'start';
                                    break;
                                case 3:
                                    anc = 'start';
                                    break;
                                case 4:
                                    anc = 'end';
                                    break;
                                case 5:
                                    anc = 'end';
                                    break;
                                default:
                                    anc = 'end';
                                    break;
                            }
                            return anc;
                        },
                        align: function (context) {
                            let pos = 'left';
                            switch (context.dataIndex) {
                                case 1:
                                    pos = 'right';
                                    break;
                                case 2:
                                    pos = 'right';
                                    break;
                                case 3:
                                    pos = 'right';
                                    break;
                                case 4:
                                    pos = 'left';
                                    break;
                                case 5:
                                    pos = 'left';
                                    break;
                                default:
                                    pos = 'left';
                                    break;
                            }
                            return pos;
                        },
                        offset: 8,
                        display: function (context) {
                            return context.dataIndex != 0;
                        },
                        font: function (context) {
                            var width = context.chart.width;
                            var size = Math.round(width / 32);
                            return {
                                size: (size <= 14) ? size : 14
                            };
                        }
                    },
                    data: currentChartData,
                }]
            };
            const chartConfig = {
                type: 'line',
                data: chartData,
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grace: '6%',
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            enabled: false
                        }
                    }
                },
                plugins: [ChartDataLabels]
            };
            const paybackChart = new Chart(
                ctx,
                chartConfig
            );
            calculateData();
            setEqData(calcData[0]);
            let daysSlider = document.getElementById('w-days');
            let daysSliderCounter = document.getElementById('w-days-counter');
            let daysMinValue = daysSlider.getAttribute('data-min');
            let daysMaxValue = daysSlider.getAttribute('data-max');
            document.getElementById('days-min').innerHTML = daysMinValue;
            document.getElementById('days-max').innerHTML = daysMaxValue;
            noUiSlider.create(daysSlider, {
                start: [1],
                step: 1,
                range: {
                    min: [+daysMinValue],
                    max: [+daysMaxValue],
                },
            });
            daysSlider.noUiSlider.on('update', function (values, handle) {
                daysSliderCounter.innerHTML = +values[0];
                currentValues.days = +values[0];
                calculateData();
            })
            let proceduresSlider = document.getElementById('w-procedures');
            let proceduresSliderCounter = document.getElementById('w-procedures-counter');
            let proceduresMinValue = proceduresSlider.getAttribute('data-min');
            let proceduresMaxValue = proceduresSlider.getAttribute('data-max');
            document.getElementById('procedures-min').innerHTML = proceduresMinValue;
            document.getElementById('procedures-max').innerHTML = proceduresMaxValue;
            document.getElementById('employee-bonus-number').innerHTML = currentValues.employee_bonus * 100;
            noUiSlider.create(proceduresSlider, {
                start: [1],
                step: 1,
                range: {
                    min: [+proceduresMinValue],
                    max: [+proceduresMaxValue],
                },
            });
            proceduresSlider.noUiSlider.on('update', function (values, handle) {
                proceduresSliderCounter.innerHTML = +values[0];
                currentValues.procedures = +values[0];
                calculateData();
            })
            let costSlider = document.getElementById('w-cost');
            let costSliderCounter = document.getElementById('w-cost-counter');
            let costMinValue = costSlider.getAttribute('data-min');
            let costMaxValue = costSlider.getAttribute('data-max');
            let costStep = costSlider.getAttribute('data-step');
            document.getElementById('cost-min').innerHTML = costMinValue;
            document.getElementById('cost-max').innerHTML = costMaxValue;
            noUiSlider.create(costSlider, {
                start: [1],
                step: +costStep,
                range: {
                    min: [+costMinValue],
                    max: [+costMaxValue],
                },
            });
            costSlider.noUiSlider.on('update', function (values, handle) {
                costSliderCounter.innerHTML = +values[0];
                currentValues.cost = +values[0];
                calculateData();
            })
            $("#eq-select").change(function (e) {
                const selectedId = e.target.value;
                calcData.forEach(item => {
                    if (item.id == selectedId) {
                        currentValues.consumables = item.consumables;
                        calculateData();
                        setEqData(item);
                        updateSlidersValues(item);
                    }
                })
            });
            function setEqData(data) {
                $('#eq-img').attr('src', data.productImg);
                $('#w-procedures').attr('data-min', data.minProcedures);
                $('#w-procedures').attr('data-max', data.maxProcedures);
                $('#procedures-min').html(data.minProcedures);
                $('#procedures-max').html(data.maxProcedures);
                $('#w-cost').attr('data-min', data.minCost);
                $('#w-cost').attr('data-max', data.maxCost);
                $('#cost-min').html(data.minCost);
                $('#cost-max').html(data.maxCost);
                $('#consumables').html(data.consumables);
            }
            function updateSlidersValues(data) {
                console.log(data);
                proceduresSlider.noUiSlider.set([data.minProcedures, data.maxProcedures]);
                costSlider.noUiSlider.updateOptions({
                    start: [1],
                    range: {
                        min: data.minCost,
                        max: data.maxCost
                    }
                }, false);
            }
            function calculateData() {
                console.log(currentValues);
                let result = currentValues.days * currentValues.procedures * currentValues.cost;
                let employeeBonus = result * currentValues.employee_bonus;
                currentValues.all_consumables = currentValues.consumables * currentValues.procedures * currentValues.days;
                let result_day = currentValues.procedures * currentValues.cost;
                let profitInDay = result_day - result_day * currentValues.employee_bonus - currentValues.consumables * currentValues.procedures;
                let profitInMonth = profitInDay * currentValues.days;
                let profitInYear = profitInDay * currentValues.days * 12;
                $('#employee-bonus').html(employeeBonus);
                $('#profit-in-day').html(profitInDay);
                $('#profit-in-month').html(profitInMonth);
                $('#profit-in-year').html(profitInYear);
                $('#consumables').html(currentValues.all_consumables);
                let yearsProfit = [0, profitInYear, profitInYear * 2, profitInYear * 3, profitInYear * 4, profitInYear * 5];
                currentChartData = yearsProfit;
                $('#profit-first-year').html(yearsProfit[1]);
                $('#profit-second-year').html(yearsProfit[2]);
                $('#profit-third-year').html(yearsProfit[3]);
                $('#profit-fourth-year').html(yearsProfit[4]);
                $('#profit-fifth-year').html(yearsProfit[5]);
                paybackChart.data.datasets[0].data = yearsProfit;
                paybackChart.update()
            }
        }
    })
</script>
<script>
        (function (d, w, s) {
            var widgetHash = 'wQVgkJI6Q07ZyjktLZZw', bch = d.createElement(s); bch.type = 'text/javascript'; bch.async = true;
            bch.src = '//widgets.binotel.com/chat/widgets/' + widgetHash + '.js';
            var sn = d.getElementsByTagName(s)[0]; sn.parentNode.insertBefore(bch, sn);
        })(document, window, 'script');
    (function (d, w, s) {
        var widgetHash = '2d08i8t925v6cjxidxul', gcw = d.createElement(s); gcw.type = 'text/javascript'; gcw.async = true;
        gcw.src = '//widgets.binotel.com/getcall/widgets/' + widgetHash + '.js';
        var sn = d.getElementsByTagName(s)[0]; sn.parentNode.insertBefore(gcw, sn);
    })(document, window, 'script');
</script>
<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "Store",
"image": [
"https://alfaspa.ua/images/ALFA-general/alfa-logo-kvadrat.jpg"
],
"name": "ALFA Medical & SPA Development",
"address": {
"@type": "PostalAddress",
"streetAddress": "вул. Січових Стрільців, 26-Б",
"addressLocality": "Київ",
"addressRegion": "Kyiv",
"postalCode": "02000",
"addressCountry": "UA"
},
"geo": {
"@type": "GeoCoordinates",
"latitude": 50.456772,
"longitude": 30.498875
},
"url": "https://alfaspa.ua",
"telephone": "0800750153"
}
</script>
<script src="/assets/components/minishop2/js/web/default.js?v=e2bdf7f5a6"></script>
<script src="/assets/components/minishop2/js/web/lib/jquery.jgrowl.min.js"></script>
<script src="/assets/components/minishop2/js/web/message_settings.js"></script>
<script src="/assets/components/ajaxform/js/default.js"></script>
<script
    type="text/javascript">AjaxForm.initialize({ "assetsUrl": "\/assets\/components\/ajaxform\/", "actionUrl": "\/assets\/components\/ajaxform\/action.php", "closeMessage": "close all", "formSelector": "form.ajax_form", "pageId": 302 });</script>
<script src="/assets/components/msearch2/js/web/default.js"></script>
<script type="text/javascript">
    if ($("form.msearch2").length) {
        mSearch2.Form.initialize("form.msearch2");
    }
</script>
<script>
    setTimeout(function () {
        var head = document.getElementsByTagName("head")[0];
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "https://www.google.com/recaptcha/api.js?render=6LfVTssgAAAAAPyr_P-UL9RcFORj5YSPPqr9b39R";
        head.appendChild(script);
        setTimeout(function () {
            grecaptcha.ready(function () {
                grecaptcha.reset = grecaptchaExecute;
                grecaptcha.reset();
            });
        }, 500);
    }, 4000)
    function grecaptchaExecute() {
        grecaptcha.execute("6LfVTssgAAAAAPyr_P-UL9RcFORj5YSPPqr9b39R", { action: "subscription_1" }).then(function (token) {
            var fieldsToken = document.querySelectorAll("[name ='g-recaptcha-response']");
            Array.prototype.forEach.call(fieldsToken, function (el, i) {
                el.value = token;
            });
        });
    };
    // обновляем капчу каждую минуту
    setInterval(function () {
        grecaptcha.reset();
    }, 60000);
</script>

</html>